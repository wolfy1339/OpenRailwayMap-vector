<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <link rel="apple-touch-icon" sizes="180x180" href="image/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="image/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="image/favicon-16x16.png">
  <link rel="manifest" href="manifest.json">

  <link rel="stylesheet" href="css/bootstrap-5.3.3/bootstrap.min.css">
  <link rel="stylesheet" href="css/maplibre-gl-4.7/maplibre-gl.css">
  <link rel="stylesheet" href="css/ui.css">

  <script>
    // See https://stackoverflow.com/a/64158043/711129
    let FF_FOUC_FIX;
  </script>

  <title>OpenRailwayMap</title>
</head>

<body>
<div id="search-backdrop" class="modal backdrop" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
    <div class="modal-content">
      <div class="modal-header bg-light">
        <h5 class="modal-title">Search</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="hideSearch()"></button>
      </div>
      <div class="modal-body">
        <ul class="nav nav-pills mb-2">
          <li class="nav-item">
            <a id="search-facilities-tab" class="nav-link active" href="javascript:searchFacilities()">Facilities</a>
          </li>
          <li class="nav-item">
            <a id="search-milestones-tab" class="nav-link" href="javascript:searchMilestones()">Milestones</a>
          </li>
        </ul>
        <form id="search-facilities-form">
          <div class="mb-3">
            <label class="form-label">Search by</label>
            <div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" id="search-all" value="all" checked>
                <label class="form-check-label" for="search-all">All</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" id="search-name" value="name">
                <label class="form-check-label" for="search-name">Name</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" id="search-ref" value="ref">
                <label class="form-check-label" for="search-ref">Reference</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="type" id="search-uic-ref" value="uic_ref">
                <label class="form-check-label" for="search-uic-ref">UIC reference</label>
              </div>
            </div>
          </div>
          <div class="input-group mb-3">
            <input type="search" id="facility-term" name="term" class="form-control" placeholder="Bruxelles, EAHS, 8000294" minlength="2" required>
            <button class="btn btn-success" type="submit">Search</button>
          </div>
        </form>
        <form id="search-milestones-form">
          <div class="row">
              <div class="col">
                <div class="input-group mb-3">
                  <label class="input-group-text" for="milestone-ref">Reference</label>
                  <input type="text" id="milestone-ref" name="ref" class="form-control" placeholder="6020" required>
                </div>
              </div>
              <div class="col">
                <div class="input-group mb-3">
                  <label class="input-group-text" for="milestone-position">Position</label>
                  <input type="number" id="milestone-position" name="position" class="form-control" placeholder="22.7" min="0" step="0.1" required>
                </div>
              </div>
              <div class="col flex-grow-0">
                <button class="btn btn-success" type="submit">Search</button>
              </div>
            </div>
        </form>
        <div id="search-results"></div>
      </div>
    </div>
  </div>
</div>
<div id="configuration-backdrop" class="modal backdrop" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header bg-light">
        <h5 class="modal-title">Map configuration</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="hideConfiguration()"></button>
      </div>
      <div class="modal-body">
        <form>
          <div class="mb-3">
            <label for="backgroundSaturation" class="form-label">Background map saturation</label>
            <input type="range" min="0.0" max="1.0" step="0.05" class="form-range" id="backgroundSaturation" onchange="updateConfiguration('backgroundSaturation', parseFloat(this.value)); updateBackgroundMapContainer();">
            <small class="form-text">
              Control the saturation of the background map. The smallest value makes the map grayscale, while the largest value makes the map full color.
            </small>
          </div>
          <div class="mb-3">
            <label for="backgroundOpacity" class="form-label" >Background map opacity</label>
            <input type="range" min="0.0" max="1.0" step="0.05" class="form-range" id="backgroundOpacity" onchange="updateConfiguration('backgroundOpacity', parseFloat(this.value)); updateBackgroundMapContainer();">
            <small class="form-text">
              Control the opacity of the background map. The smallest value makes the map transparent, while the largest value makes the map opaque.
            </small>
          </div>
          <div class="mb-3">
            <label for="backgroundUrl" class="form-label" >Background map tile URL</label>
            <div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="backgroundType" id="backgroundTypeRaster" value="raster" checked onchange="updateConfiguration('backgroundType', 'raster'); updateBackgroundMapStyle();">
                <label class="form-check-label" for="backgroundTypeRaster">Raster</label>
              </div>
              <div class="form-check form-check-inline">
                <input class="form-check-input" type="radio" name="backgroundType" id="backgroundTypeVector" value="raster" checked onchange="updateConfiguration('backgroundType', 'vector'); updateBackgroundMapStyle();">
                <label class="form-check-label" for="backgroundTypeVector">Vector</label>
              </div>
            </div>
            <input type="url" required class="form-control" id="backgroundUrl" onchange="updateConfiguration('backgroundUrl', this.value); updateBackgroundMapStyle();">
            <small class="form-text">
              The tile URL for the background map.<br>
              Raster tiles: A URL serving raster tiles. See <a href="https://wiki.openstreetmap.org/wiki/Raster_tile_providers" target="_blank">the wiki</a> for a list of raster tile providers, for example <code>https://tile.openstreetmap.org/{z}/{x}/{y}.png</code>.<br>
              Vector tiles: A URL specifying a vector style. See <a href="https://wiki.openstreetmap.org/wiki/Vector_tiles#Providers" target="_blank">the wiki</a> for a list of vector tile providers, for example <code>https://americanamap.org/style.json</code>.
            </small>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
<div id="legend">
  <div id="legend-map"></div>
</div>
<div id="map-container">
  <div id="background-map"></div>
  <div id="map"></div>
</div>

<script src="js/maplibre-gl-4.7/maplibre-gl.js"></script>
<script src="js/ui.js"></script>
</body>

</html>
